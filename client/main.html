<head>
  <title>No 209</title>
  <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.43.0/css/font-awesome.min.css' rel='stylesheet' />
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>
<body>

</body>

<template name="main">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="{{pathFor route='home'}}"><img src="/images/logo_50px.png" style="height:100%;" /></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            {{#if currentUser}}
            <li><a href="{{pathFor route='mylistings'}}">My Listings</a></li>
            <li><a href="{{pathFor route='mymessages'}}">Messages</a></li>
            {{/if}}
            <li><a href="{{pathFor route='about'}}">About</a></li>
          </ul>
          
          <ul class="nav navbar-nav navbar-right">
            <li>{{> loginButtons align="right"}}</li>
          </ul>
        </div>
      </div>
    </nav>


    {{> yield}}

</template>

<template name="mylistings">
    <div class="col-md-12 left-side">
    {{#unless isVerified}}<div class="alert alert-warning" role="alert">Your email is not yet verified so you cannot create a listing or contact anyone on the site.  <a href="#" id="sendverifyemail">Verify your email</a> now to start in the fun!</div>{{/unless}}
    <h2>Your Listings&nbsp;&nbsp;{{#if isVerified}}<a href="/new" style="font-size:65%;"><i class="fa fa-plus"></i> Add Listing</a>{{/if}}</h2>
    {{#unless results.count}}0 listings{{/unless}}
    <ul>
    {{#each results}}
    <li><a href="{{pathFor route='listing' _id=_id }}">{{title}}</a>&nbsp;&nbsp;<a href="{{pathFor route='update' _id=_id }}" target="_self"><i class="fa fa-pencil"></i></a></li>
    {{/each}}
    </ul>
    </div>
</template>

<template name="mymessages">
    <div class="col-md-12 left-side">

    <h2>Your Inbox</h2>
    <ul>
    {{#unless receivedmessages.count}}0 messages{{/unless}}
    {{#each receivedmessages}}
     <li>{{formatDate createdAt}} <strong>{{contactor.profile.firstname}} {{contactor.profile.lastname}}</strong> - {{comment}}  <a href="{{pathFor route='listing' _id=listingId }}">listing</a></li>
    {{/each}}
    </ul>

    <h2>Your Sent Messages</h2>
    <ul>
    {{#unless sentmessages.count}}0 messages{{/unless}}
    {{#each sentmessages}}
     <li>{{formatDate createdAt}} <strong>{{contactTo.profile.firstname}} {{contactTo.profile.lastname}}</strong> - {{comment}} <a href="{{pathFor route='listing' _id=listingId }}">listing</a></li>
    {{/each}}
    </ul>
    </div>
</template>

<template name="listing">
    <div class="col-md-8 left-side" id="listing">
      <h1>{{#if verifyRequested}}<a href="{{pathFor route='about'}}"><img src="/images/verified_badge_lg.png" title="209 Verified Listing"></a>{{/if}}  {{title}}</h1>
      <div class="contact-link">
      {{#unless isOwner userId}}
        {{#if currentUser}}
        <a href="#" id="comment">Contact <i class="fa fa-envelope"></i></a>
        {{else}}
        Sign in / join to send a message
        {{/if}}
      {{else}}
        <a href="{{pathFor route='update' _id=_id }}">Edit listing <i class="fa fa-pencil"></i></a>
      {{/unless}}
      </div>

      <div class="popup-gallery">
      <section class="block" style="clear:both;">
          <div id="myCarousel" class="carousel slide">
              <div class="carousel-inner">

                  <div class="active item">
                  <a href="{{photourl.url}}" title="Main Image">
                      <img src="{{photourl.url}}" class="img-responsive" style="width:100%;"/>
                  </a>
                  </div>
              </div>
          </div>
      </section>
      <br /><br />
      {{#each photos}}
       <a href="{{photosurl.url store='extras'}}" title="{{title}}">
          <img src="{{photosurl.url store='thumbs'}}" title="{{title}}">
       </a>
       {{/each}}
    </div>
      <p></p>
      <p></p>
    </div>
    <div class="col-md-4 right-side listing">
      <div class="spacey"></div>
      {{#if isOwner userId}}
        <h3>Inbox</h3>
        {{#unless contacts.count}}No messages yet{{/unless}}
        <ul>
        {{#each contacts}}
        <li>{{formatDate createdAt}} <strong>{{contactor.profile.firstname}} {{contactor.profile.lastname}}</strong> - {{comment}} <a href="#" id="contactreply"><i class="fa fa-reply"></i></a></li>
        {{/each}}
        </ul>
        
        {{#if contacted.count}}<h3>My Sent Messages</h3>{{/if}}
        <ul>
        {{#each contacted}}
        <li>{{formatDate createdAt}} <strong>{{contactTo.profile.firstname}} {{contactTo.profile.lastname}}</strong> - {{comment}}</li>
        {{/each}}
        </ul>

      {{else}}
        {{#if currentUser}}
            {{#if contacted.count}}<h3>My Sent Messages</h3>{{/if}}
            <ul>
            {{#each contacted}}
            <li>{{formatDate createdAt}} - {{comment}}</li>
            {{/each}}
            </ul>


            {{#if responses.count}}<h3>Replies from Owner</h3>{{/if}}
            <ul>
            {{#each responses}}
            <li>{{formatDate createdAt}} - {{comment}} <a href="#" id="contactreply"><i class="fa fa-reply"></i></a></li>
            {{/each}}
            </ul>
          {{/if}}
      {{/if}}

    <div class="details">
    <h3>Details</h3>
    <strong>Type:</strong> {{listingType}}<br />
    <strong>Price:</strong> ${{price}}/month<br />
    <strong>Power:</strong> {{#if hasPower}}Yes{{else}}No{{/if}}<br />
    <strong>Water:</strong> {{#if hasWater}}Yes{{else}}No{{/if}}<br />
    <strong>SQ Feet:</strong> {{sqFeet}}<br />
    <strong>Max Height:</strong> {{maxHeight}}<br /><br />
    <div class="description"><p>{{breaklines description}}</p></div>

    </div>
    
    </div>
    

      
</template>

<template name="home">

    <div class="col-md-7 left-side" id="listings">
      <div class="row filters">
        <div class="col-md-6 col-xs-12">
          <select name="listingType" class="form-control" id="listingtype">
            <option value="spot house">Show All</option>
            <option value="spot">Tiny Parking Spots Only</option>
            <option value="house">Tiny Houses Only</option>
          </select>
        </div>
        <div class="col-md-6 col-xs-12 verified">
           <label for="verified"><input type="checkbox" name="verified" id="verified" value="1"> 209 Verified Listings Only&nbsp;&nbsp;<a href="{{pathFor route='about'}}"><img src="/images/verified_badge.png" title="209 Verified Badge: Click to learn more" height="23px"></a></label>
           
        </div>

      </div>
      <div class="row filters">
        <div class="col-xs-12">
          <div id="slider-low"></div><div id="slider"></div><div id="slider-high"></div>
        </div>
      </div>

      {{#unless results.count}}
        <h4>We couldnâ€™t find any results that matched your criteria, but tweaking your search may help. Here are some ideas:</h4>
        <ul>
        <li>Remove some filters.</li>
        <li>Expand the area of your search.</li>
        <li>Search for a city, address, or landmark.</li>
        </ul>
      {{/unless}}
      {{#each results}}
        <div class="col-md-6">
        <div class="listing">
          <a href="{{pathFor route='listing' _id=_id }}">
            {{#if verifyRequested}}<div class="overlay-verified"><img src="/images/verified_badge.png" title="209 Verified Listing"></div>{{/if}}
            <div class="overlay-price">$ {{price}}/mo</div>
            <img src="{{photourl.url store='tiles'}}" class="img-responsive" style="width:100%;"/>
            <div class="details"><h3 class="listing-title">{{title}}</h3></div>
          </a>
           {{#unless isOwner userId}}
            {{#if currentUser}}
            <div class="contact-link"><a href="#" id="comment">Contact <i class="fa fa-envelope"></i></a></div>
            {{/if}}
          {{/unless}}

        </div>
      </div>
      {{/each}}

    </div>

    <div class="col-md-5 right-side home">
     <div id="overlay" style="position:absolute; top:100px; right:0px; height:50px; width:75%; z-index: 100">
       <form class="locate-search">
        <input type="text" name="text" placeholder="Find location" style="width:75%;" />
       </form>
     </div>

    {{> map}}
    </div>
</template>

<template name="map">
      <div id="map" class="map"></div>
</template>

<template name="new">
  <div class="spacey"></div>
  <div class="col-md-6">
    <h1>Create Listing</h1>
    {{#autoForm id="insertForm" type="insert" collection="Listings"}}
    {{> afQuickField name="listingType"}}
    {{> afQuickField name="title"}}
    {{> afQuickField name="address"}}
    {{> afQuickField name="price"}}
    {{> afQuickField name="hasPower"}}
    {{> afQuickField name="hasWater"}}
    {{> afQuickField name="sqFeet"}}
    {{> afQuickField name="maxHeight"}}
    {{> afQuickField name="description" rows=6}}
    {{> afQuickField name="verifyRequested"}}
    {{> afQuickField name="photo"}}
    {{> afQuickField name="coordinates" class="coordinates"}}
    <button type="submit">Submit</button>
    {{/autoForm}}
    <br /><br />
  </div>

</template>


<template name="update">
  <div class="spacey"></div>
  <div class="col-md-6">
    <h1>Update Listing</h1>
    <div class="upload-images" style="float:right;"><a href="#" id="uploadimages"><i class="fa fa-picture-o"></i> Manage additional images</a> | <a href="{{pathFor route='listing' _id=_id }}"> View Listing</a></div>
    <br />
    {{#autoForm id="updateForm" doc=this type="update" collection="Listings"}}
    {{> afQuickField name="listingType"}}
    {{> afQuickField name="title"}}
    {{> afQuickField name="address"}}
    {{> afQuickField name="price"}}
    {{> afQuickField name="hasPower"}}
    {{> afQuickField name="hasWater"}}
    {{> afQuickField name="sqFeet"}}
    {{> afQuickField name="maxHeight"}}
    {{> afQuickField name="description" rows=6}}
    {{> afQuickField name="verifyRequested"}}
    {{> afQuickField name="photo"}}
    {{> afQuickField name="coordinates" class="coordinates"}}
    <button type="submit">Submit</button>
    {{/autoForm}}
    <br /><br />
  </div>

</template>

<template name="clear">
  <div class="spacey"></div>
  <div class="col-md-6">
    <h1>Clear Collections</h1>
    All collection items have been deleted.
    {{clear}}
  </div>

</template>

<template name="about">
  <div class="always-spacey"></div>
  <div class="col-md-7">
    <h1>About</h1>
    <h3>Welcome to no 209, the tiny house movement's marketplace</h3>
    <p>We believe that there are a lot of tiny spaces to fill with tiny homes and encourage home and landowners to list their available space for tiny house parking. Have a tiny already that needs a great occupant? Post that too!</p>
    <p><strong>Looking for a place to park your tiny or a tiny already parked and ready to move into?</strong> Browse around and when you're ready to learn more about a spot just hit the contact button and send the owner a note. See what unfolds from there.</p>
    <p><strong>Have a place to park a tiny?</strong> Create an account and post a listing. Then let the tiny owners find you.</p>
  </div>
  <div class="col-md-5">
    <div class="spacey"></div>
    <p><img src="/images/verified_badge_lg.png" title="209 Verified Listing" align="left" style="padding-right: 10px; padding-bottom: 500px; padding-top: 10px;"><h3>209 Verified</h3> Look for these listings that have been personally reviewed by us on location. We have measured the site, sized up the overall space to ensure that the listing is accurate and taken some great photos to show it off best. This hands on expert assessment gives you piece of mind when shopping for a tiny home or home for your tiny.
    <br /><br />
    Want your listing to be 209 Verified?  <a href="#">Contact us</a> to schedule a visit.
    </p> 
  </div>

</template>


<template name="commentModal">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Contact</h4>
                </div>

                <div class="modal-body">
                    {{#unless isVerified}}<div class="alert alert-warning" role="alert">Your email is not yet verified so you cannot contact anyone on the site.  <a href="#" id="sendverifyemail">Verify your email</a> now to start in the fun!</div>{{/unless}}
                    {{#if isVerified}}
                    {{#autoForm id="insertComment" type="insert" collection="Contacts"}}
                    {{> afQuickField name="comment" rows=6}}
                    {{> afQuickField name="listingId" value=listingid}}
                     
                    <button type="submit">Submit</button>
                    {{/autoForm}}
                    {{/if}}

                </div>


            </div>
        </div>
    </div>
</template>

<template name="fileUploader">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Additional Images</h4>
                </div>

                <div class="modal-body">
                    <h3>Upload New</h3>
                    {{#if maxImages}}
                        Oops, you're at the max. Only 10 additional images can be uploaded.
                    {{else}}
                      {{#autoForm id="insertGallery" type="insert" collection="Photos"}}
                      {{> afQuickField name="title"}}
                      {{> afQuickField name="photo"}}
                      {{> afQuickField name="listingId" value=listingid}}
                       
                      <button type="submit">Submit</button>
                      {{/autoForm}}
                    {{/if}}

                    <h3>Manage Existing</h3>
                    {{#unless photos.count}}No photos, upload some above.{{/unless}}
                    <ul class="photos">
                    {{#each photos}}
                    <li><img src="{{photosurl.url store='thumbs'}}" width="75px"> {{title}}</li>
                    {{/each}}
                    </ul>
                </div>


            </div>
        </div>
    </div>
</template>

<template name="contactReply">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Reply</h4>
                </div>


                <div class="modal-body">
                  {{#unless isVerified}}<div class="alert alert-warning" role="alert">Your email is not yet verified so you cannot contact anyone on the site.  <a href="#" id="sendverifyemail">Verify your email</a> now to start in the fun!</div>{{/unless}}
                  
                  {{#if isVerified}}
                  <h3>Reply to: {{contacts.profile.firstname}} {{contacts.profile.lastname}}</h3>
                  <br />
      

                    {{#autoForm id="insertComment" type="insert" collection="Contacts"}}
                    {{> afQuickField name="comment" rows=6}}
                    {{> afQuickField name="listingId" value=listingid}}
                    {{> afQuickField name="userIdTo" value=contacts._id}}
                     
                    <button type="submit">Submit</button>
                    {{/autoForm}}
                  {{/if}}

                </div>


            </div>
        </div>
    </div>
</template>